# WEB3 - Nibert Investments Web3 Products Repository

**ALWAYS follow these instructions first and fallback to additional search and context gathering only if the information here is incomplete or found to be in error.**

## Repository Overview

This is a multi-language Web3 repository containing Node.js, Python, and Solidity components for Nibert Investments Web3 products. **Currently in early development state** - most files are skeleton/empty files with only the Node.js server component fully functional.

## Working Effectively

### Prerequisites & Environment Setup
```bash
# Verify environment (these should already be available)
node --version    # Expected: v20.19.4 or similar
npm --version     # Expected: 10.8.2 or similar  
python3 --version # Expected: Python 3.12.3 or similar
```

### Node.js Component (FUNCTIONAL)
```bash
# Install dependencies (FAST: ~300ms)
npm install

# Run the server (FUNCTIONAL - serves "Hello World" on port 3000)
npm start
# OR
node server.js

# Test server is working
curl http://127.0.0.1:3000/
# Expected output: "Hello World"
```

**TIMING**: Server startup takes 1-2 seconds. NEVER CANCEL server commands.

### Python Component (SKELETON STATE)
```bash
# Python files exist but are empty (main.py contains only newlines)
python3 main.py  # Runs but outputs nothing

# Python build will FAIL - no setup.py or pyproject.toml exists yet
python -m pip install build
python -m build  # FAILS: "does not appear to be a Python project"
```

**WARNING**: Python publishing workflow (.github/workflows/python-publish.yml) exists but will fail until project structure is created.

### Solidity Component (SKELETON STATE)
```bash
# Solidity file exists but is empty (main.sol contains only newlines)
# No Solidity compiler or tools installed
which solc     # NOT FOUND
which truffle  # NOT FOUND  
which hardhat  # NOT FOUND
```

**WARNING**: No Web3/blockchain development tools are currently installed.

### Testing & Validation

#### Manual Validation Requirements
**CRITICAL**: After making any changes, ALWAYS run these validation steps:

1. **Node.js Server Validation**:
   ```bash
   npm start &
   SERVER_PID=$!
   sleep 3
   curl http://127.0.0.1:3000/  # Should return "Hello World"
   kill $SERVER_PID
   ```

2. **File Integrity Check**:
   ```bash
   # Verify core files exist and are not corrupted
   ls -la main.js main.py main.sol server.js
   node -c server.js  # Syntax check
   python3 -m py_compile main.py  # Python syntax check (if not empty)
   ```

#### CI Pipeline Validation
```bash
# Test Node.js CI workflow commands (from .github/workflows/node.js.yml)
npm ci          # Requires package-lock.json (generated by npm install)
npm run build --if-present  # Currently no-op (no build script defined)
npm test        # FAILS: "no test specified" - this is expected current state
```

**TIMING EXPECTATIONS**:
- `npm install`: ~300ms (no dependencies currently)
- `npm ci`: ~200ms (after package-lock.json exists)
- `npm test`: Immediate failure (expected - no tests defined)
- `npm run build --if-present`: Immediate success (no-op)

### Build & Test Commands

#### What Currently Works
```bash
npm install     # ✅ WORKS: Creates package-lock.json
npm ci          # ✅ WORKS: After npm install run once
npm start       # ✅ WORKS: Starts HTTP server on port 3000
node server.js  # ✅ WORKS: Direct server execution
npm run build --if-present  # ✅ WORKS: No-op (no build script)
```

#### What Currently Fails (Expected)
```bash
npm test                # ❌ FAILS: "Error: no test specified" 
python -m build         # ❌ FAILS: No Python project structure
```

### Repository Structure
```
.
├── .github/
│   └── workflows/
│       ├── node.js.yml                    # Node.js CI (tests across v18.x, v20.x, v22.x)
│       ├── python-publish.yml             # Python PyPI publishing
│       └── generator-generic-ossf-slsa3-publish.yml  # SLSA provenance
├── LICENSE                                 # MIT License
├── README.md                              # Basic project description  
├── main.js                                # Empty JavaScript file
├── main.py                                # Empty Python file
├── main.sol                               # Empty Solidity file
├── server.js                              # ✅ FUNCTIONAL: Basic HTTP server
├── package.json                           # Generated by npm init
└── package-lock.json                      # Generated by npm install
```

## Common Development Patterns

### Making Changes to Node.js Components
1. **ALWAYS test server functionality after changes**:
   ```bash
   node -c server.js  # Syntax check first
   npm start &
   sleep 3
   curl http://127.0.0.1:3000/
   killall node
   ```

### Adding Dependencies
```bash
# For Node.js
npm install <package-name>
npm ci  # Always run after adding dependencies

# For Python (when project structure exists)
# Currently not applicable - no requirements.txt or pyproject.toml
```

### Before Committing Changes
```bash
# Verify Node.js functionality
node -c server.js
npm start &
sleep 3
curl http://127.0.0.1:3000/
killall node

# No linting tools configured yet - add when project grows
```

## GitHub Workflows

### Node.js CI (.github/workflows/node.js.yml)
- Runs on: push/PR to main branch
- Tests Node.js versions: 18.x, 20.x, 22.x
- Commands: `npm ci`, `npm run build --if-present`, `npm test`
- **CURRENT STATE**: Will fail on `npm test` (expected until tests are added)

### Python Publish (.github/workflows/python-publish.yml)  
- Triggers: On release creation
- **CURRENT STATE**: Will fail (no Python project structure exists)

### SLSA Provenance (.github/workflows/generator-generic-ossf-slsa3-publish.yml)
- Generates artifact provenance for supply chain security
- Creates basic artifacts for demonstration

## Troubleshooting

### Common Issues
1. **"npm ci" fails**: Run `npm install` first to generate package-lock.json
2. **Server won't start**: Check if port 3000 is already in use
3. **Python build fails**: Expected - no project structure exists yet
4. **Tests fail**: Expected - no test suite defined yet

### When GitHub CI Fails
- Node.js CI will fail on the `npm test` step (expected)
- Python workflows will fail entirely (expected)
- Only commit Node.js server changes that maintain "Hello World" functionality

## Important Notes

**CRITICAL WARNINGS**:
- Repository is in early development - most components are placeholder files
- Only server.js contains functional code
- GitHub workflows expect functionality not yet implemented
- Always validate Node.js server works after changes
- NEVER CANCEL server startup commands - they start quickly (1-2 seconds)

**Web3 Development**:
- No blockchain development tools installed yet
- Solidity files are empty placeholders
- Will need Hardhat, Truffle, or similar framework when Solidity development begins

**Multi-Language Support**:
- Repository structure supports Node.js, Python, and Solidity
- Currently only Node.js component is functional
- Add project structure for Python/Solidity as development progresses